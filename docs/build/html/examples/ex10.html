

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>10. Example 10: Knapsack Problem &mdash; NEORL 1.7.6b documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Example 11: Microreactor Control with Malfunction" href="ex11.html" />
    <link rel="prev" title="9. Example 9: Cantilever Stepped Beam" href="ex9.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NEORL
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                main (1.7.6b )
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../guide/guide.html">General Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/modules.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tune/tune.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ex1.html">1. Example 1: Traveling Salesman Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex2.html">2. Example 2: Ackley with EA</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex3.html">3. Example 3: Welded-beam design</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex4.html">4. Example 4: Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex5.html">5. Example 5: CEC’2017 Test Suite</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex6.html">6. Example 6: Three-bar Truss Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex7.html">7. Example 7: Pressure Vessel Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex8.html">8. Example 8: Pressure Vessel Design with Demonstration of Categorical Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex9.html">9. Example 9: Cantilever Stepped Beam</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10. Example 10: Knapsack Problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summary">10.1. Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#problem-description">10.2. Problem Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#neorl-script">10.3. NEORL script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">10.4. Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ex11.html">11. Example 11: Microreactor Control with Malfunction</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contrib.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contribguide.html">Contribution Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NEORL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="examples.html">Examples</a> &raquo;</li>
        
      <li><span class="section-number">10. </span>Example 10: Knapsack Problem</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/ex10.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example-10-knapsack-problem">
<span id="ex10"></span><h1><span class="section-number">10. </span>Example 10: Knapsack Problem<a class="headerlink" href="#example-10-knapsack-problem" title="Permalink to this headline">¶</a></h1>
<p>Example of solving the classical discrete optimization problem “Knapsack Problem” (KP) using NEORL with state-of-the-art reinforcement learning algorithms to demonstrate compatibility with discrete space.</p>
<div class="section" id="summary">
<h2><span class="section-number">10.1. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Algorithm: PPO,A2C, ACKTR, DQN, ACER</p></li>
<li><p>Type: Discrete/Combinatorial, Single Objective, Constrained</p></li>
<li><p>Field: Computational mathematics</p></li>
</ul>
</div>
<div class="section" id="problem-description">
<h2><span class="section-number">10.2. </span>Problem Description<a class="headerlink" href="#problem-description" title="Permalink to this headline">¶</a></h2>
<p>The Knapsack Problem (KP) is another combinatorial problem that has been studied for decades. It often arises in resource allocation problem, machine scheduling, and asset optimization for instance. It consists in maximizing the value of a set of items placed in a bag limited by the weight capacity <span class="math notranslate nohighlight">\(W\)</span> of the bag. The figure below illustrates the problem. The maximum weight that the bag can contain is 15kg. The optimum set of items is obtained by taking all of them instead of the 12 kg one. A good heuristic is to choose the item with the lowest weight-to-value ratio.</p>
<a class="reference internal image-reference" href="../_images/kp.png"><img alt="alternate text" class="align-center" src="../_images/kp.png" style="width: 360.0px; height: 312.0px;" /></a>
<p>Formally, with <span class="math notranslate nohighlight">\(i = 1,...,n\)</span> items, each characterized by their values and weights <span class="math notranslate nohighlight">\((\nu_i,w_i)\)</span>, the problem can be formulated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\max \sum_{i=1}^n\nu_ix_i \\
&amp;s.t. \quad \sum_{i=1}^nw_ix_i \le W \\
&amp;x_i \in \{0,1\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_i=1\)</span> if the item <span class="math notranslate nohighlight">\(i\)</span> is in the bag, otherwise <span class="math notranslate nohighlight">\(x_i=0\)</span>. This is called the 0-1 Knapsack Problem. The constraint characterizes the fact that the capacity of the bag is limited by <span class="math notranslate nohighlight">\(W\)</span>, hence the sum of the weights <span class="math notranslate nohighlight">\(\sum_{i=1}^nw_ix_i\)</span> of the items should not exceed <span class="math notranslate nohighlight">\(W\)</span>.</p>
</div>
<div class="section" id="neorl-script">
<h2><span class="section-number">10.3. </span>NEORL script<a class="headerlink" href="#neorl-script" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#--------------------------------------------------------</span>
<span class="c1"># Import Packages</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="kn">from</span> <span class="nn">neorl.benchmarks</span> <span class="kn">import</span> <span class="n">KP</span>
<span class="kn">from</span> <span class="nn">neorl</span> <span class="kn">import</span> <span class="n">PPO2</span><span class="p">,</span> <span class="n">DQN</span><span class="p">,</span> <span class="n">ACER</span><span class="p">,</span> <span class="n">ACKTR</span><span class="p">,</span> <span class="n">A2C</span>
<span class="kn">from</span> <span class="nn">neorl</span> <span class="kn">import</span> <span class="n">MlpPolicy</span><span class="p">,</span> <span class="n">DQNPolicy</span>
<span class="kn">from</span> <span class="nn">neorl</span> <span class="kn">import</span> <span class="n">RLLogger</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># KP Data</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">KP_Data</span><span class="p">(</span><span class="n">n_objects</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">    Function provides initial data to construct a Knapsack problem enviroment</span>
<span class="sd">    </span>
<span class="sd">    :param n_objects: (int) number of objects, choose either 50 or 100</span>
<span class="sd">    :return: obj_list (list), optimum_knapsack (list), episode_length (int), weight_capacity (int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n_objects</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
        <span class="c1">#---50 objects </span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>\
                    <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>\
                    <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
        <span class="c1">#optimal solution for comparison</span>
        <span class="n">optimum_knapsack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">49</span><span class="p">]</span>
        <span class="c1">#episode length</span>
        <span class="n">episode_length</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">weight_capacity</span> <span class="o">=</span> <span class="mi">125</span>
    
    <span class="k">elif</span> <span class="n">n_objects</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
    
        <span class="c1">#---100 objects </span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
        <span class="c1">#optimal solution for comparison</span>
        <span class="n">optimum_knapsack</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span>\
                                    <span class="mi">70</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">74</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">86</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">93</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>  
        
        <span class="c1">#episode length</span>
        <span class="n">episode_length</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">weight_capacity</span><span class="o">=</span> <span class="mi">250</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;--error: n_objects is not defined, either choose 50 or 100&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="p">,</span> <span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span>

<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># User Parameters for RL Optimisation</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">total_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1">#get time steps as external argument (for quick testing)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">total_steps</span><span class="o">=</span><span class="mi">8000</span>      <span class="c1">#or use default total time steps to run all optimizers</span>
    
<span class="n">n_steps</span><span class="o">=</span><span class="mi">12</span>         <span class="c1">#update frequency for A2C, ACKTR, PPO</span>
<span class="n">n_objects</span><span class="o">=</span><span class="mi">50</span>       <span class="c1">#number of objects: choose 50 or 100</span>
<span class="n">n_sum_steps</span><span class="o">=</span><span class="mi">10</span>     <span class="c1">#this is for logging and averaging purposes</span>

<span class="c1">#---get some data to initialize the enviroment---</span>
<span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="p">,</span> <span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span><span class="o">=</span><span class="n">KP_Data</span><span class="p">(</span><span class="n">n_objects</span><span class="o">=</span><span class="n">n_objects</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># DQN</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="c1">#create an enviroment object from the class</span>
<span class="n">env</span><span class="o">=</span><span class="n">KP</span><span class="p">(</span><span class="n">obj_list</span><span class="o">=</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="o">=</span><span class="n">optimum_knapsack</span><span class="p">,</span> 
        <span class="n">episode_length</span><span class="o">=</span><span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span><span class="o">=</span><span class="n">weight_capacity</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;dqn&#39;</span><span class="p">)</span>
<span class="c1">#create a callback function to log data</span>
<span class="n">cb_dqn</span><span class="o">=</span><span class="n">RLLogger</span><span class="p">(</span><span class="n">check_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#To activate logger plotter, add following arguments to cb_dqn: </span>
<span class="c1">#plot_freq = 50,n_avg_steps=10,pngname=&#39;DQN-reward&#39; </span>
<span class="c1">#Also applicable to ACER.</span>

<span class="c1">#create a RL object based on the env object</span>
<span class="n">dqn</span> <span class="o">=</span> <span class="n">DQN</span><span class="p">(</span><span class="n">DQNPolicy</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#optimise the enviroment class</span>
<span class="n">dqn</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">total_steps</span><span class="o">*</span><span class="n">n_sum_steps</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb_dqn</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># ACER</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="n">env</span><span class="o">=</span><span class="n">KP</span><span class="p">(</span><span class="n">obj_list</span><span class="o">=</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="o">=</span><span class="n">optimum_knapsack</span><span class="p">,</span> 
        <span class="n">episode_length</span><span class="o">=</span><span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span><span class="o">=</span><span class="n">weight_capacity</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;acer&#39;</span><span class="p">)</span>
<span class="n">cb_acer</span><span class="o">=</span><span class="n">RLLogger</span><span class="p">(</span><span class="n">check_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">acer</span> <span class="o">=</span> <span class="n">ACER</span><span class="p">(</span><span class="n">MlpPolicy</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">acer</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">total_steps</span><span class="o">*</span><span class="n">n_sum_steps</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb_acer</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># PPO</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="n">env</span><span class="o">=</span><span class="n">KP</span><span class="p">(</span><span class="n">obj_list</span><span class="o">=</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="o">=</span><span class="n">optimum_knapsack</span><span class="p">,</span> 
        <span class="n">episode_length</span><span class="o">=</span><span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span><span class="o">=</span><span class="n">weight_capacity</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;ppo&#39;</span><span class="p">)</span>
<span class="n">cb_ppo</span><span class="o">=</span><span class="n">RLLogger</span><span class="p">(</span><span class="n">check_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#To activate logger plotter, add following arguments to cb_ppo: </span>
<span class="c1">#plot_freq = 1, n_avg_steps=10, pngname=&#39;PPO-reward&#39; </span>
<span class="c1">#Also applicable to A2C, ACKTR.</span>
<span class="n">ppo</span> <span class="o">=</span> <span class="n">PPO2</span><span class="p">(</span><span class="n">MlpPolicy</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ppo</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">total_steps</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb_ppo</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># ACKTR</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="n">env</span><span class="o">=</span><span class="n">KP</span><span class="p">(</span><span class="n">obj_list</span><span class="o">=</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="o">=</span><span class="n">optimum_knapsack</span><span class="p">,</span> 
        <span class="n">episode_length</span><span class="o">=</span><span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span><span class="o">=</span><span class="n">weight_capacity</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;acktr&#39;</span><span class="p">)</span>
<span class="n">cb_acktr</span><span class="o">=</span><span class="n">RLLogger</span><span class="p">(</span><span class="n">check_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">acktr</span> <span class="o">=</span> <span class="n">ACKTR</span><span class="p">(</span><span class="n">MlpPolicy</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">acktr</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">total_steps</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb_acktr</span><span class="p">)</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="c1"># A2C</span>
<span class="c1">#--------------------------------------------------------</span>
<span class="n">env</span><span class="o">=</span><span class="n">KP</span><span class="p">(</span><span class="n">obj_list</span><span class="o">=</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">optimum_knapsack</span><span class="o">=</span><span class="n">optimum_knapsack</span><span class="p">,</span> 
        <span class="n">episode_length</span><span class="o">=</span><span class="n">episode_length</span><span class="p">,</span> <span class="n">weight_capacity</span><span class="o">=</span><span class="n">weight_capacity</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;a2c&#39;</span><span class="p">)</span>
<span class="n">cb_a2c</span><span class="o">=</span><span class="n">RLLogger</span><span class="p">(</span><span class="n">check_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">a2c</span> <span class="o">=</span> <span class="n">A2C</span><span class="p">(</span><span class="n">MlpPolicy</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">a2c</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">total_steps</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">cb_a2c</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>
<span class="c1">#Summary Results</span>
<span class="c1">#--------------------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------- DQN results ---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of x found:&#39;</span><span class="p">,</span> <span class="n">cb_dqn</span><span class="o">.</span><span class="n">xbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of y found:&#39;</span><span class="p">,</span> <span class="n">cb_dqn</span><span class="o">.</span><span class="n">rbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------- ACER results ---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of x found:&#39;</span><span class="p">,</span> <span class="n">cb_acer</span><span class="o">.</span><span class="n">xbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of y found:&#39;</span><span class="p">,</span> <span class="n">cb_acer</span><span class="o">.</span><span class="n">rbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------- PPO results ---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of x found:&#39;</span><span class="p">,</span> <span class="n">cb_ppo</span><span class="o">.</span><span class="n">xbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of y found:&#39;</span><span class="p">,</span> <span class="n">cb_ppo</span><span class="o">.</span><span class="n">rbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------- ACKTR results ---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of x found:&#39;</span><span class="p">,</span> <span class="n">cb_acktr</span><span class="o">.</span><span class="n">xbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of y found:&#39;</span><span class="p">,</span> <span class="n">cb_acktr</span><span class="o">.</span><span class="n">rbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------- A2C results ---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of x found:&#39;</span><span class="p">,</span> <span class="n">cb_a2c</span><span class="o">.</span><span class="n">xbest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The best value of y found:&#39;</span><span class="p">,</span> <span class="n">cb_a2c</span><span class="o">.</span><span class="n">rbest</span><span class="p">)</span>

<span class="c1">#--------------------------------</span>
<span class="c1">#Summary Plots</span>
<span class="c1">#--------------------------------</span>

<span class="n">log_dqn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cb_dqn</span><span class="o">.</span><span class="n">r_hist</span><span class="p">)</span><span class="o">.</span><span class="n">cummax</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">log_acer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cb_acer</span><span class="o">.</span><span class="n">r_hist</span><span class="p">)</span><span class="o">.</span><span class="n">cummax</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">log_ppo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cb_ppo</span><span class="o">.</span><span class="n">r_hist</span><span class="p">)</span><span class="o">.</span><span class="n">cummax</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">log_acktr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cb_acktr</span><span class="o">.</span><span class="n">r_hist</span><span class="p">)</span><span class="o">.</span><span class="n">cummax</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">log_a2c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cb_a2c</span><span class="o">.</span><span class="n">r_hist</span><span class="p">)</span><span class="o">.</span><span class="n">cummax</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="k">def</span> <span class="nf">update_log_dqn_acer</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">n_sum_steps</span><span class="p">):</span>
    <span class="c1"># This is a helper function to convert right logger for DQN/ACER to</span>
    <span class="c1"># to be equivalent to other algs. </span>
    <span class="c1">#Inputs:</span>
        <span class="c1">#log: orginal DQN/ACER logger</span>
        <span class="c1">#n_sum_steps: number of steps to group and sum. </span>
    <span class="c1">#Outputs:</span>
        <span class="c1">#updated_log: the converted log for DQN/ACER</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">tolist</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">updated_log</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n_sum_steps</span><span class="p">])</span><span class="o">/</span><span class="n">n_sum_steps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">n_sum_steps</span><span class="p">)]</span>
    <span class="n">updated_log</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">updated_log</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">updated_log</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#remove extraneous entries</span>
    <span class="k">return</span> <span class="n">updated_log</span>    

<span class="c1">#update the DQN/ACER loggers</span>
<span class="n">log_dqn</span><span class="o">=</span><span class="n">update_log_dqn_acer</span><span class="p">(</span><span class="n">log_dqn</span><span class="p">,</span> <span class="n">n_sum_steps</span><span class="p">)</span>
<span class="n">log_acer</span><span class="o">=</span><span class="n">update_log_dqn_acer</span><span class="p">(</span><span class="n">log_acer</span><span class="p">,</span> <span class="n">n_sum_steps</span><span class="p">)</span>

<span class="c1">#plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_dqn</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;DQN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_acer</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;ACER&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_ppo</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;PPO&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_acktr</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;ACKTR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_a2c</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;A2C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Best Knapsack value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;kp_history.png&quot;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span> <span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="results">
<h2><span class="section-number">10.4. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>A summary of the results is shown below for the case of <strong>50 items/objects</strong>. First, all five reinforcement algorithms are compared in terms of maximizing the sum of item weights. The fitness convergence shows that PPO and ACKTR are the best algorithms in this case, with PPO slightly achieved a better fitness. Therefore, we will limit the reported results to PPO.</p>
<a class="reference internal image-reference" href="../_images/kp_cost.png"><img alt="alternate text" class="align-center" src="../_images/kp_cost.png" style="width: 428.75px; height: 324.5px;" /></a>
<p>The maximum value of the Knapsack tour cost found by PPO is 188, which is fairly close to the optimal sum of item values of 204. The <strong>PPO Knapsack</strong> is below</p>
<a class="reference internal image-reference" href="../_images/best_kp.png"><img alt="alternate text" class="align-center" src="../_images/best_kp.png" style="width: 415.5px; height: 368.0px;" /></a>
<p>while here is the target <strong>optimal</strong> Knapsack</p>
<a class="reference internal image-reference" href="../_images/optimal_kp.png"><img alt="alternate text" class="align-center" src="../_images/optimal_kp.png" style="width: 415.5px; height: 382.0px;" /></a>
<p>And here are the final results of all algorithms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">---------------</span> <span class="n">DQN</span> <span class="n">results</span> <span class="o">---------------</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="n">found</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;25&#39;</span><span class="p">,</span> <span class="s1">&#39;26&#39;</span><span class="p">,</span> <span class="s1">&#39;27&#39;</span><span class="p">,</span> <span class="s1">&#39;28&#39;</span><span class="p">,</span> <span class="s1">&#39;29&#39;</span><span class="p">,</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="s1">&#39;36&#39;</span><span class="p">,</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="s1">&#39;35&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;37&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="s1">&#39;41&#39;</span><span class="p">]</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">y</span> <span class="n">found</span><span class="p">:</span> <span class="mf">175.0</span>
<span class="o">---------------</span> <span class="n">ACER</span> <span class="n">results</span> <span class="o">---------------</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="n">found</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;41&#39;</span><span class="p">,</span> <span class="s1">&#39;36&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;13&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="s1">&#39;49&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;26&#39;</span><span class="p">,</span> <span class="s1">&#39;25&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;28&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="s1">&#39;29&#39;</span><span class="p">,</span> <span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;43&#39;</span><span class="p">,</span> <span class="s1">&#39;27&#39;</span><span class="p">]</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">y</span> <span class="n">found</span><span class="p">:</span> <span class="mf">186.0</span>
<span class="o">---------------</span> <span class="n">PPO</span> <span class="n">results</span> <span class="o">---------------</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="n">found</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;28&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="s1">&#39;47&#39;</span><span class="p">,</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="s1">&#39;29&#39;</span><span class="p">,</span> <span class="s1">&#39;49&#39;</span><span class="p">,</span> <span class="s1">&#39;26&#39;</span><span class="p">,</span> <span class="s1">&#39;41&#39;</span><span class="p">,</span> <span class="s1">&#39;43&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;35&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;36&#39;</span><span class="p">,</span> <span class="s1">&#39;44&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;34&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;25&#39;</span><span class="p">,</span> <span class="s1">&#39;27&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">]</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">y</span> <span class="n">found</span><span class="p">:</span> <span class="mf">188.0</span>
<span class="o">---------------</span> <span class="n">ACKTR</span> <span class="n">results</span> <span class="o">---------------</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="n">found</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;29&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;36&#39;</span><span class="p">,</span> <span class="s1">&#39;39&#39;</span><span class="p">,</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="s1">&#39;34&#39;</span><span class="p">,</span> <span class="s1">&#39;14&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;25&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;46&#39;</span><span class="p">,</span> <span class="s1">&#39;28&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;49&#39;</span><span class="p">,</span>
<span class="s1">&#39;26&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;35&#39;</span><span class="p">,</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;38&#39;</span><span class="p">]</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">y</span> <span class="n">found</span><span class="p">:</span> <span class="mf">187.0</span>
<span class="o">---------------</span> <span class="n">A2C</span> <span class="n">results</span> <span class="o">---------------</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x</span> <span class="n">found</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;28&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;43&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;36&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;35&#39;</span><span class="p">,</span> <span class="s1">&#39;46&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;41&#39;</span><span class="p">,</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;38&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;29&#39;</span><span class="p">,</span> <span class="s1">&#39;44&#39;</span><span class="p">,</span> <span class="s1">&#39;49&#39;</span><span class="p">,</span> <span class="s1">&#39;48&#39;</span><span class="p">,</span> <span class="s1">&#39;37&#39;</span><span class="p">,</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">]</span>
<span class="n">The</span> <span class="n">best</span> <span class="n">value</span> <span class="n">of</span> <span class="n">y</span> <span class="n">found</span><span class="p">:</span> <span class="mf">181.0</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ex11.html" class="btn btn-neutral float-right" title="11. Example 11: Microreactor Control with Malfunction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ex9.html" class="btn btn-neutral float-left" title="9. Example 9: Cantilever Stepped Beam" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Exelon Corp. &amp; MIT.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>