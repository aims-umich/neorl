

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Prioritized replay Evolutionary and Swarm Algorithm (PESA) &mdash; NEORL 1.7.8b documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Modern PESA (PESA2)" href="pesa2.html" />
    <link rel="prev" title="Recurrent Neuroevolution of Augmenting Topologies (RNEAT)" href="rneat.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> NEORL
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                main (1.7.8b )
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../guide/guide.html">General Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../neural/neural.html">Neural Algorithms (Reinforcement Learning)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolutionary/evolutionary.html">Evolutionary and Swarm Algorithms</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="neuroevolu.html">Hybrid and Neuroevolution Algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fneat.html">Feedforward Neuroevolution of Augmenting Topologies (FNEAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="rneat.html">Recurrent Neuroevolution of Augmenting Topologies (RNEAT)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Prioritized replay Evolutionary and Swarm Algorithm (PESA)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-can-you-use">What can you use?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pesa2.html">Modern PESA (PESA2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ppoes.html">RL-informed Evolution Strategies (PPO-ES)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ackde.html">RL-informed Differential Evolution (ACKTR-DE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="nga.html">Neural Genetic Algorithms (NGA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="nhho.html">Neural Harris Hawks Optimization (NHHO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="aeo.html">Animorphic Ensemble Optimization (AEO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="edev.html">Ensemble of Differential Evolution Variants (EDEV)</a></li>
<li class="toctree-l3"><a class="reference internal" href="epso.html">Ensemble Particle Swarm Optimization (EPSO)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tune/tune.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contrib.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contribguide.html">Contribution Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NEORL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../modules.html">Algorithms</a> &raquo;</li>
        
          <li><a href="neuroevolu.html">Hybrid and Neuroevolution Algorithms</a> &raquo;</li>
        
      <li>Prioritized replay Evolutionary and Swarm Algorithm (PESA)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/neuroevolu/pesa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-neorl.hybrid.pesa"><span id="pesa"></span></span><div class="section" id="prioritized-replay-evolutionary-and-swarm-algorithm-pesa">
<h1>Prioritized replay Evolutionary and Swarm Algorithm (PESA)<a class="headerlink" href="#prioritized-replay-evolutionary-and-swarm-algorithm-pesa" title="Permalink to this headline">¶</a></h1>
<p>A module for the parallel hybrid PESA algorithm with prioritized experience replay from reinforcement learning. This is the classical PESA that hybridizes PSO, ES, and SA modules within NEORL.</p>
<p>Original paper: Radaideh, M. I., &amp; Shirvan, K. (2022). PESA: Prioritized experience replay for parallel hybrid evolutionary and swarm algorithms-Application to nuclear fuel. Nuclear Engineering and Technology.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.net.2022.05.001">https://doi.org/10.1016/j.net.2022.05.001</a></p>
<div class="section" id="what-can-you-use">
<h2>What can you use?<a class="headerlink" href="#what-can-you-use" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Multi processing: ✔️</p></li>
<li><p>Discrete spaces: ✔️</p></li>
<li><p>Continuous spaces: ✔️</p></li>
<li><p>Mixed Discrete/Continuous spaces: ✔️</p></li>
</ul>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neorl.hybrid.pesa.PESA">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">neorl.hybrid.pesa.</span></span><span class="sig-name descname"><span class="pre">PESA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_backdoor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cxpb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutpb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed_mech</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constric'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neorl/hybrid/pesa.html#PESA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neorl.hybrid.pesa.PESA" title="Permalink to this definition">¶</a></dt>
<dd><p><em>PESA Major Parameters</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> – (str) problem type, either “min” for minimization problem or “max” for maximization</p></li>
<li><p><strong>bounds</strong> – (dict) input parameter type and lower/upper bounds in dictionary form. Example: <code class="docutils literal notranslate"><span class="pre">bounds={'x1':</span> <span class="pre">['int',</span> <span class="pre">1,</span> <span class="pre">4],</span> <span class="pre">'x2':</span> <span class="pre">['float',</span> <span class="pre">0.1,</span> <span class="pre">0.8],</span> <span class="pre">'x3':</span> <span class="pre">['float',</span> <span class="pre">2.2,</span> <span class="pre">6.2]}</span></code></p></li>
<li><p><strong>fit</strong> – (function) the fitness function</p></li>
<li><p><strong>npop</strong> – (int) total number of individuals in each group. So for ES, PSO, and SA, full population is <code class="docutils literal notranslate"><span class="pre">npop*3</span></code>.</p></li>
<li><p><strong>mu</strong> – (int) number of individuals to survive to the next generation. 
Also, <code class="docutils literal notranslate"><span class="pre">mu</span></code> equals to the number of individuals to sample from the memory. If None, <code class="docutils literal notranslate"><span class="pre">mu=int(npop/2)</span></code>.
So 1/2 of PESA population comes from previous generation, and 1/2 comes from the replay memory (See <strong>Notes</strong> below for more info)</p></li>
<li><p><strong>memory_size</strong> – (int) max size of the replay memory (if None, <code class="docutils literal notranslate"><span class="pre">memory_size</span></code> is built to accommodate all samples during search)</p></li>
<li><p><strong>alpha_init</strong> – (float) initial value of the prioritized replay coefficient (See <strong>Notes</strong> below)</p></li>
<li><p><strong>alpha_end</strong> – (float) final value of the prioritized replay coefficient (See <strong>Notes</strong> below)</p></li>
<li><p><strong>alpha_backdoor</strong> – (float) backdoor greedy replay rate/probability to sample from the memory for SA instead of random-walk (See <strong>Notes</strong> below)</p></li>
</ul>
</dd>
</dl>
<p><em>PESA Auxiliary Parameters (for the internal algorithms)</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cxpb</strong> – (float) for <strong>ES</strong>, population crossover probability between [0,1]</p></li>
<li><p><strong>mutpb</strong> – (float) for <strong>ES</strong>, population mutation probability between [0,1]</p></li>
<li><p><strong>c1</strong> – (float) for <strong>PSO</strong>, cognitive speed constant</p></li>
<li><p><strong>c2</strong> – (float) for <strong>PSO</strong>, social speed constant</p></li>
<li><p><strong>speed_mech</strong> – (str) for <strong>PSO</strong>, type of speed mechanism for to update particle velocity, choose between <code class="docutils literal notranslate"><span class="pre">constric</span></code>, <code class="docutils literal notranslate"><span class="pre">timew</span></code>, <code class="docutils literal notranslate"><span class="pre">globw</span></code>.</p></li>
<li><p><strong>Tmax</strong> – (float) for <strong>SA</strong>, initial/max temperature to start the annealing process</p></li>
<li><p><strong>chi</strong> – (float) for <strong>SA</strong>, probability to perturb an attribute during SA annealing (occurs when <code class="docutils literal notranslate"><span class="pre">rand(0,1)</span> <span class="pre">&lt;</span> <span class="pre">chi</span></code>).</p></li>
</ul>
</dd>
</dl>
<p><em>PESA Misc. Parameters</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncores</strong> – (int) number of parallel processors</p></li>
<li><p><strong>seed</strong> – (int) random seed for sampling</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="neorl.hybrid.pesa.PESA.evolute">
<span class="sig-name descname"><span class="pre">evolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neorl/hybrid/pesa.html#PESA.evolute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neorl.hybrid.pesa.PESA.evolute" title="Permalink to this definition">¶</a></dt>
<dd><p>This function evolutes the PESA algorithm for number of generations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngen</strong> – (int) number of generations to evolute</p></li>
<li><p><strong>x0</strong> – (list of lists) initial samples to start the replay memory (<code class="docutils literal notranslate"><span class="pre">len(x0)</span></code> must be equal or more than <code class="docutils literal notranslate"><span class="pre">npop</span></code>)</p></li>
<li><p><strong>warmup</strong> – (int) number of random warmup samples to initialize the replay memory and must be equal or more than <code class="docutils literal notranslate"><span class="pre">npop</span></code> (only used if <code class="docutils literal notranslate"><span class="pre">x0=None</span></code>)</p></li>
<li><p><strong>verbose</strong> – (int) print statistics to screen, 0: no print, 1: PESA print, 2: detailed print</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(tuple) (best individual, best fitness, and a list of fitness history)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neorl</span> <span class="kn">import</span> <span class="n">PESA</span>

<span class="c1">#Define the fitness function</span>
<span class="k">def</span> <span class="nf">FIT</span><span class="p">(</span><span class="n">individual</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sphere test objective function.</span>
<span class="sd">            F(x) = sum_{i=1}^d xi^2</span>
<span class="sd">            d=1,2,3,...</span>
<span class="sd">            Range: [-100,100]</span>
<span class="sd">            Minima: 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">individual</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span> 

<span class="c1">#Setup the parameter space (d=5)</span>
<span class="n">nx</span><span class="o">=</span><span class="mi">5</span>
<span class="n">BOUNDS</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">BOUNDS</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">npop</span><span class="o">=</span><span class="mi">60</span>
<span class="n">pesa</span><span class="o">=</span><span class="n">PESA</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">BOUNDS</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">FIT</span><span class="p">,</span> <span class="n">npop</span><span class="o">=</span><span class="n">npop</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">alpha_init</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
          <span class="n">alpha_end</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha_backdoor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ncores</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x0</span><span class="o">=</span><span class="p">[[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npop</span><span class="p">)]</span>  <span class="c1">#initial guess</span>
<span class="n">x_best</span><span class="p">,</span> <span class="n">y_best</span><span class="p">,</span> <span class="n">pesa_hist</span><span class="o">=</span><span class="n">pesa</span><span class="o">.</span><span class="n">evolute</span><span class="p">(</span><span class="n">ngen</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>PESA is symmetric, meaning population size is equal between PSO, ES, and SA, which is helpful to ensure that all algorithms can update the memory with similar computing time. For example, if the user sets <code class="docutils literal notranslate"><span class="pre">npop=60</span></code>, then in every generation, the swarm of PSO has 60 particles, ES population has 60 individuals, and SA chain has length of 60.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code> defines the number of individuals from <code class="docutils literal notranslate"><span class="pre">npop</span></code> to survive to the next generation, and also the number of samples to replay from the memory. This is applicable to PSO and ES alone as SA does not have the concept of population. For example, by setting <code class="docutils literal notranslate"><span class="pre">mu=40</span></code> and <code class="docutils literal notranslate"><span class="pre">npop=60</span></code>, then after every generation, the top 40 individuals in PSO and ES survive. Then the replay memory feeds 40 individuals to ES, which form the new pool of 80 individuals that go through offspring processes that produce again <code class="docutils literal notranslate"><span class="pre">npop=60</span></code>. For PSO, the replay memory provides <code class="docutils literal notranslate"><span class="pre">60-40=20</span></code> particles to form a new swarm of <code class="docutils literal notranslate"><span class="pre">npop=60</span></code>.</p></li>
<li><p>For complex problems and limited memory, we recommend to set <code class="docutils literal notranslate"><span class="pre">memory_size</span> <span class="pre">~</span> <span class="pre">5000</span></code>. When the memory gets full, old samples are overwritten by new ones. Allowing a large memory for complex problems may slow down PESA as handling large memories is more computationally exhaustive. If <code class="docutils literal notranslate"><span class="pre">memory_size</span> <span class="pre">=</span> <span class="pre">None</span></code>, the memory size will be set to maximum value of <code class="docutils literal notranslate"><span class="pre">ngen*npop*3</span></code>.</p></li>
<li><p>For parallel computing of PESA, pick <code class="docutils literal notranslate"><span class="pre">ncores</span></code> divisible by 3 (e.g. 6, 18, 30) to ensure equal computing power across the internal algorithms.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">ncores=1</span></code>, serial calculation of PESA is executed.</p></li>
<li><p>Example on how to assign computing resources for PESA. Lets assume a generation of <code class="docutils literal notranslate"><span class="pre">npop=60</span></code> individuals and <code class="docutils literal notranslate"><span class="pre">ncores=30</span></code>. Then, <code class="docutils literal notranslate"><span class="pre">icores=int(ncores/3)</span></code> or <code class="docutils literal notranslate"><span class="pre">icores=10</span></code> cores are assigned to each algorithm of PSO, ES, and SA. In this case, the ES population has size <code class="docutils literal notranslate"><span class="pre">npop=60</span></code> and it is evaluated in parallel with 10 cores. PSO swarm also has <code class="docutils literal notranslate"><span class="pre">npop=60</span></code> particles evaluated with 10 cores. SA releases 10 parallel chains, each chain evaluates 6 individuals.</p></li>
<li><p>Check the sections of <a class="reference internal" href="../evolutionary/pso.html#pso"><span class="std std-ref">PSO</span></a>, <a class="reference internal" href="../evolutionary/es.html#es"><span class="std std-ref">ES</span></a>, and <a class="reference internal" href="../evolutionary/sa.html#sa"><span class="std std-ref">SA</span></a> for notes on the internal algorithms and the auxiliary parameters of PESA.</p></li>
<li><p>Start the prioritized replay with a small fraction for <code class="docutils literal notranslate"><span class="pre">alpha_init</span> <span class="pre">&lt;</span> <span class="pre">0.1</span></code> to increase randomness earlier to improve PESA exploration. Choose a high fraction for <code class="docutils literal notranslate"><span class="pre">alpha_end</span> <span class="pre">&gt;</span> <span class="pre">0.9</span></code> to increase exploitation by the end of evolution.</p></li>
<li><p>The rate of <code class="docutils literal notranslate"><span class="pre">alpha_backdoor</span></code> replaces the regular random-walk sample of SA with the best individual in the replay memory to keep SA chain up-to-date. For example, <code class="docutils literal notranslate"><span class="pre">alpha_backdoor=0.1</span></code> implies that out of 10 individuals in the SA chain, 1 comes from the memory and the other 9 come from classical random-walk. Keep the value of <code class="docutils literal notranslate"><span class="pre">alpha_backdoor</span></code> small enough, e.g. <code class="docutils literal notranslate"><span class="pre">alpha_backdoor</span> <span class="pre">&lt;</span> <span class="pre">0.2</span></code>, to avoid SA divergence.</p></li>
<li><p>Look for an optimal balance between <code class="docutils literal notranslate"><span class="pre">npop</span></code> and <code class="docutils literal notranslate"><span class="pre">ngen</span></code>, it is recommended to minimize population size to allow for more generations.</p></li>
<li><p>Total number of cost evaluations for PESA is <code class="docutils literal notranslate"><span class="pre">ngen*npop*3</span> <span class="pre">+</span> <span class="pre">warmup</span></code>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pesa2.html" class="btn btn-neutral float-right" title="Modern PESA (PESA2)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="rneat.html" class="btn btn-neutral float-left" title="Recurrent Neuroevolution of Augmenting Topologies (RNEAT)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Exelon Corp. &amp; MIT.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>