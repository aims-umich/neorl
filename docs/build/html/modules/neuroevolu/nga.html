

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Neural Genetic Algorithms (NGA) &mdash; NEORL 1.7.8b documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Neural Harris Hawks Optimization (NHHO)" href="nhho.html" />
    <link rel="prev" title="RL-informed Differential Evolution (ACKTR-DE)" href="ackde.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> NEORL
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                main (1.7.8b )
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../guide/guide.html">General Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../neural/neural.html">Neural Algorithms (Reinforcement Learning)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolutionary/evolutionary.html">Evolutionary and Swarm Algorithms</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="neuroevolu.html">Hybrid and Neuroevolution Algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fneat.html">Feedforward Neuroevolution of Augmenting Topologies (FNEAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="rneat.html">Recurrent Neuroevolution of Augmenting Topologies (RNEAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pesa.html">Prioritized replay Evolutionary and Swarm Algorithm (PESA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pesa2.html">Modern PESA (PESA2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ppoes.html">RL-informed Evolution Strategies (PPO-ES)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ackde.html">RL-informed Differential Evolution (ACKTR-DE)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Neural Genetic Algorithms (NGA)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-can-you-use">What can you use?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nhho.html">Neural Harris Hawks Optimization (NHHO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="aeo.html">Animorphic Ensemble Optimization (AEO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="edev.html">Ensemble of Differential Evolution Variants (EDEV)</a></li>
<li class="toctree-l3"><a class="reference internal" href="epso.html">Ensemble Particle Swarm Optimization (EPSO)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tune/tune.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contrib.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contribguide.html">Contribution Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NEORL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../modules.html">Algorithms</a> &raquo;</li>
        
          <li><a href="neuroevolu.html">Hybrid and Neuroevolution Algorithms</a> &raquo;</li>
        
      <li>Neural Genetic Algorithms (NGA)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/neuroevolu/nga.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-neorl.hybrid.nga"><span id="nga"></span></span><div class="section" id="neural-genetic-algorithms-nga">
<h1>Neural Genetic Algorithms (NGA)<a class="headerlink" href="#neural-genetic-algorithms-nga" title="Permalink to this headline">¶</a></h1>
<p>A module for the surrogate-based genetic algorithms trained by offline data-driven tri-training approach. The surrogate model used is radial basis function networks (RBFN).</p>
<p>Original paper: Huang, P., Wang, H., &amp; Jin, Y. (2021). Offline data-driven evolutionary optimization based on tri-training. Swarm and Evolutionary Computation, 60, 100800.</p>
<div class="section" id="what-can-you-use">
<h2>What can you use?<a class="headerlink" href="#what-can-you-use" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Multi processing: ❌</p></li>
<li><p>Discrete spaces: ❌</p></li>
<li><p>Continuous spaces: ✔️</p></li>
<li><p>Mixed Discrete/Continuous spaces: ❌</p></li>
</ul>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neorl.hybrid.nga.NGA">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">neorl.hybrid.nga.</span></span><span class="sig-name descname"><span class="pre">NGA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_warmups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neorl/hybrid/nga.html#NGA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neorl.hybrid.nga.NGA" title="Permalink to this definition">¶</a></dt>
<dd><p>Neural Genetic Algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> – (str) problem type, either “min” for minimization problem or “max” for maximization</p></li>
<li><p><strong>bounds</strong> – (dict) input parameter type and lower/upper bounds in dictionary form. Example: <code class="docutils literal notranslate"><span class="pre">bounds={'x1':</span> <span class="pre">['int',</span> <span class="pre">1,</span> <span class="pre">4],</span> <span class="pre">'x2':</span> <span class="pre">['float',</span> <span class="pre">0.1,</span> <span class="pre">0.8],</span> <span class="pre">'x3':</span> <span class="pre">['float',</span> <span class="pre">2.2,</span> <span class="pre">6.2]}</span></code></p></li>
<li><p><strong>fit</strong> – (function) the fitness function</p></li>
<li><p><strong>npop</strong> – (int) population size of genetic algorithms</p></li>
<li><p><strong>num_warmups</strong> – (int) number of warmup samples to train the surrogate which will be evaluated by the real fitness <code class="docutils literal notranslate"><span class="pre">fit</span></code> (if <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">num_warmups=20*len(bounds)</span></code>)</p></li>
<li><p><strong>hidden_shape</strong> – (int) number of hidden layers in the RBFN network (if <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">hidden_shape=int(sqrt(int(num_warmups/3)))</span></code>)</p></li>
<li><p><strong>kernel</strong> – (str) kernel type for the RBFN network (choose from <code class="docutils literal notranslate"><span class="pre">gaussian</span></code>, <code class="docutils literal notranslate"><span class="pre">reflect</span></code>, <code class="docutils literal notranslate"><span class="pre">mul</span></code>, <code class="docutils literal notranslate"><span class="pre">inmul</span></code>)</p></li>
<li><p><strong>ncores</strong> – (int) number of parallel processors (currently only <code class="docutils literal notranslate"><span class="pre">ncores=1</span></code> is supported)</p></li>
<li><p><strong>seed</strong> – (int) random seed for sampling</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="neorl.hybrid.nga.NGA.evolute">
<span class="sig-name descname"><span class="pre">evolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neorl/hybrid/nga.html#NGA.evolute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neorl.hybrid.nga.NGA.evolute" title="Permalink to this definition">¶</a></dt>
<dd><p>This function evolutes the NGA algorithm for number of generations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngen</strong> – (int) number of generations to evolute</p></li>
<li><p><strong>verbose</strong> – (bool) print statistics to screen</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(tuple) (list of best individuals, list of best fitnesses)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neorl</span> <span class="kn">import</span> <span class="n">NGA</span>

<span class="c1">#Define the fitness function</span>
<span class="k">def</span> <span class="nf">FIT</span><span class="p">(</span><span class="n">individual</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sphere test objective function.</span>
<span class="sd">                    F(x) = sum_{i=1}^d xi^2</span>
<span class="sd">                    d=1,2,3,...</span>
<span class="sd">                    Range: [-100,100]</span>
<span class="sd">                    Minima: 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">individual</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="c1">#Setup the parameter space (d=5)</span>
<span class="n">nx</span><span class="o">=</span><span class="mi">5</span>
<span class="n">BOUNDS</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">BOUNDS</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">nga</span> <span class="o">=</span> <span class="n">NGA</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">BOUNDS</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">FIT</span><span class="p">,</span> <span class="n">npop</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">num_warmups</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> 
          <span class="n">hidden_shape</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">individuals</span><span class="p">,</span> <span class="n">surrogate_fit</span> <span class="o">=</span> <span class="n">nga</span><span class="o">.</span><span class="n">evolute</span><span class="p">(</span><span class="n">ngen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#make evaluation of the best individuals using the real fitness function</span>
<span class="n">real_fit</span><span class="o">=</span><span class="p">[</span><span class="n">FIT</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">]</span>

<span class="c1">#print the best individuals/fitness found</span>
<span class="n">min_index</span><span class="o">=</span><span class="n">real_fit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">real_fit</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------ Final Summary --------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best real individual:&#39;</span><span class="p">,</span> <span class="n">individuals</span><span class="p">[</span><span class="n">min_index</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best real fitness:&#39;</span><span class="p">,</span> <span class="n">real_fit</span><span class="p">[</span><span class="n">min_index</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------------------------------&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Tri-training concept uses semi-supervised learning to leverage surrogate models that approximate the real fitness function to accelerate the optimization process for expensive fitness functions. Three RBFN models are trained, which are used to determine the best individual from one generation to the next, which is added to retrain the three surrogate models. The real fitness function <code class="docutils literal notranslate"><span class="pre">fit</span></code> is ONLY used to evaluate <code class="docutils literal notranslate"><span class="pre">num_warmups</span></code>. Afterwards, the three RBFN models are used to guide the genetic algorithm optimizer.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_warmups</span></code>, choose a reasonable value to accommodate the number of design variables <code class="docutils literal notranslate"><span class="pre">x</span></code> in your problem. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default value of warmup samples is 20 times the size of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">hidden_shape</span></code>, large number of hidden layers can slow down surrogate training, small number can lead to underfitting. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default value of <code class="docutils literal notranslate"><span class="pre">hidden_shape</span></code> is <span class="math notranslate nohighlight">\(int(\sqrt{int(num_{warmups}/3)})\)</span>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">kernel</span></code> can play a significant role in surrogate training. Four options are available: Gaussian function (<code class="docutils literal notranslate"><span class="pre">gaussian</span></code>), Reflected function (<code class="docutils literal notranslate"><span class="pre">reflect</span></code>), Multiquadric function (<code class="docutils literal notranslate"><span class="pre">mul</span></code>), and Inverse multiquadric function (<code class="docutils literal notranslate"><span class="pre">inmul</span></code>).</p></li>
<li><p>Total number of cost evaluations via the real fitness function <code class="docutils literal notranslate"><span class="pre">fit</span></code> for NGA is <code class="docutils literal notranslate"><span class="pre">num_warmups</span></code>.</p></li>
<li><p>Total number of cost evaluations via the surrogate model for NGA is <code class="docutils literal notranslate"><span class="pre">npop</span></code> * <code class="docutils literal notranslate"><span class="pre">ngen</span></code>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="nhho.html" class="btn btn-neutral float-right" title="Neural Harris Hawks Optimization (NHHO)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ackde.html" class="btn btn-neutral float-left" title="RL-informed Differential Evolution (ACKTR-DE)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Exelon Corp. &amp; MIT.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>