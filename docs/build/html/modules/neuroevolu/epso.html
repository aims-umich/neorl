

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Ensemble Particle Swarm Optimization (EPSO) &mdash; NEORL 1.7.8b documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Hyperparameter Tuning" href="../../tune/tune.html" />
    <link rel="prev" title="Ensemble of Differential Evolution Variants (EDEV)" href="edev.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> NEORL
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                main (1.7.8b )
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../guide/guide.html">General Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../neural/neural.html">Neural Algorithms (Reinforcement Learning)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolutionary/evolutionary.html">Evolutionary and Swarm Algorithms</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="neuroevolu.html">Hybrid and Neuroevolution Algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fneat.html">Feedforward Neuroevolution of Augmenting Topologies (FNEAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="rneat.html">Recurrent Neuroevolution of Augmenting Topologies (RNEAT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pesa.html">Prioritized replay Evolutionary and Swarm Algorithm (PESA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pesa2.html">Modern PESA (PESA2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ppoes.html">RL-informed Evolution Strategies (PPO-ES)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ackde.html">RL-informed Differential Evolution (ACKTR-DE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="nga.html">Neural Genetic Algorithms (NGA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="nhho.html">Neural Harris Hawks Optimization (NHHO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="aeo.html">Animorphic Ensemble Optimization (AEO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="edev.html">Ensemble of Differential Evolution Variants (EDEV)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Ensemble Particle Swarm Optimization (EPSO)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-can-you-use">What can you use?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tune/tune.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contrib.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contribguide.html">Contribution Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NEORL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../modules.html">Algorithms</a> &raquo;</li>
        
          <li><a href="neuroevolu.html">Hybrid and Neuroevolution Algorithms</a> &raquo;</li>
        
      <li>Ensemble Particle Swarm Optimization (EPSO)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/neuroevolu/epso.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-neorl.hybrid.epso"><span id="epso"></span></span><div class="section" id="ensemble-particle-swarm-optimization-epso">
<h1>Ensemble Particle Swarm Optimization (EPSO)<a class="headerlink" href="#ensemble-particle-swarm-optimization-epso" title="Permalink to this headline">¶</a></h1>
<p>A powerful hybrid ensemble of five particle swarm optimization variants: classical inertia weight particle swarm optimization (PSO), self-organizing hierarchical particle swarm optimizer withtime-varying acceleration coefficients (HPSO-TVAC), Fitness-Distance-Ratio based PSO (FDR-PSO), Distance-based locally informed PSO (LIPS), and Comprehensive Learning PSO (CLPSO).</p>
<p>Original paper: Lynn, N., Suganthan, P. N. (2017). Ensemble particle swarm optimizer. Applied Soft Computing, 55, 533-548.</p>
<div class="section" id="what-can-you-use">
<h2>What can you use?<a class="headerlink" href="#what-can-you-use" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Multi processing: ✔️</p></li>
<li><p>Discrete spaces: ✔️</p></li>
<li><p>Continuous spaces: ✔️</p></li>
<li><p>Mixed Discrete/Continuous spaces: ✔️</p></li>
</ul>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neorl.hybrid.epso.EPSO">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">neorl.hybrid.epso.</span></span><span class="sig-name descname"><span class="pre">EPSO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest_int'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neorl/hybrid/epso.html#EPSO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neorl.hybrid.epso.EPSO" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensemble Particle Swarm Optimization (EPSO)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> – (str) problem type, either <code class="docutils literal notranslate"><span class="pre">min</span></code> for minimization problem or <code class="docutils literal notranslate"><span class="pre">max</span></code> for maximization</p></li>
<li><p><strong>bounds</strong> – (dict) input parameter type and lower/upper bounds in dictionary form. Example: <code class="docutils literal notranslate"><span class="pre">bounds={'x1':</span> <span class="pre">['int',</span> <span class="pre">1,</span> <span class="pre">4],</span> <span class="pre">'x2':</span> <span class="pre">['float',</span> <span class="pre">0.1,</span> <span class="pre">0.8],</span> <span class="pre">'x3':</span> <span class="pre">['float',</span> <span class="pre">2.2,</span> <span class="pre">6.2]}</span></code></p></li>
<li><p><strong>fit</strong> – (function) the fitness function</p></li>
<li><p><strong>g1</strong> – (int): number of particles in the exploration group</p></li>
<li><p><strong>g2</strong> – (int): number of particles in the exploitation group (total swarm size is <code class="docutils literal notranslate"><span class="pre">g1</span> <span class="pre">+</span> <span class="pre">g2</span></code>)</p></li>
<li><p><strong>int_transform</strong> – (str): method of handling int/discrete variables, choose from: <code class="docutils literal notranslate"><span class="pre">nearest_int</span></code>, <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>, <code class="docutils literal notranslate"><span class="pre">minmax</span></code>.</p></li>
<li><p><strong>ncores</strong> – (int) number of parallel processors (must be <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">g1+g2</span></code>)</p></li>
<li><p><strong>seed</strong> – (int) random seed for sampling</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="neorl.hybrid.epso.EPSO.evolute">
<span class="sig-name descname"><span class="pre">evolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/neorl/hybrid/epso.html#EPSO.evolute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neorl.hybrid.epso.EPSO.evolute" title="Permalink to this definition">¶</a></dt>
<dd><p>This function evolutes the EPSO algorithm for a number of generations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngen</strong> – (int) number of generations to evolute</p></li>
<li><p><strong>LP</strong> – (int) number of generations before updating the success and failure memories for the ensemble variants (i.e. learning period)</p></li>
<li><p><strong>x0</strong> – (list of lists) initial position of the particles (must be of same size as <code class="docutils literal notranslate"><span class="pre">g1</span> <span class="pre">+</span> <span class="pre">g2</span></code>)</p></li>
<li><p><strong>verbose</strong> – (bool) print statistics to screen</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(tuple) (best individual, best fitness, and dictionary containing major search results)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neorl</span> <span class="kn">import</span> <span class="n">EPSO</span>

<span class="c1">#Define the fitness function</span>
<span class="k">def</span> <span class="nf">FIT</span><span class="p">(</span><span class="n">individual</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sphere test objective function.</span>
<span class="sd">                    F(x) = sum_{i=1}^d xi^2</span>
<span class="sd">                    d=1,2,3,...</span>
<span class="sd">                    Range: [-100,100]</span>
<span class="sd">                    Minima: 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">individual</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="c1">#Setup the parameter space (d=5)</span>
<span class="n">nx</span><span class="o">=</span><span class="mi">5</span>
<span class="n">BOUNDS</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">BOUNDS</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="c1">#setup and evolute EPSO</span>
<span class="n">epso</span><span class="o">=</span><span class="n">EPSO</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">BOUNDS</span><span class="p">,</span> <span class="n">g1</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">g2</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">FIT</span><span class="p">,</span> <span class="n">ncores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">x_best</span><span class="p">,</span> <span class="n">y_best</span><span class="p">,</span> <span class="n">epso_hist</span><span class="o">=</span><span class="n">epso</span><span class="o">.</span><span class="n">evolute</span><span class="p">(</span><span class="n">ngen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">LP</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The number of particles in the exploration subgroup (<code class="docutils literal notranslate"><span class="pre">g1</span></code>) and exploitation subgroup (<code class="docutils literal notranslate"><span class="pre">g2</span></code>) are needed for EPSO. In the original algorithm, <code class="docutils literal notranslate"><span class="pre">g1</span></code> tends to be smaller than <code class="docutils literal notranslate"><span class="pre">g2</span></code>.</p></li>
<li><p>For EPSO, in the first 90% of the generations, both exploration and exploitation subgroups are involved, where <code class="docutils literal notranslate"><span class="pre">g1</span></code> is controlled by CLPSO and <code class="docutils literal notranslate"><span class="pre">g2</span></code> is controlled by all five variants. In the last 10% of the generations, the search focuses on exploitation only, where both <code class="docutils literal notranslate"><span class="pre">g1</span> <span class="pre">+</span> <span class="pre">g2</span></code> are controlled by the five variants.</p></li>
<li><p>The value of LP represents the learning period at which the success and fail memories are updated to calculate the success rate for each PSO variant. The success rate represents the probability for each PSO variant to update the position and velocity of the next particle in the group. <code class="docutils literal notranslate"><span class="pre">LP=3</span></code> means the update will occur every 3 generations.</p></li>
<li><p>Look for an optimal balance between <code class="docutils literal notranslate"><span class="pre">g1</span></code>, <code class="docutils literal notranslate"><span class="pre">g2</span></code>, and <code class="docutils literal notranslate"><span class="pre">ngen</span></code>, it is recommended to minimize particle size to allow for more generations.</p></li>
<li><p>Total number of cost evaluations for EPSO is <code class="docutils literal notranslate"><span class="pre">(g1</span> <span class="pre">+</span> <span class="pre">g2)</span></code> * <code class="docutils literal notranslate"><span class="pre">(ngen</span> <span class="pre">+</span> <span class="pre">1)</span></code>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../tune/tune.html" class="btn btn-neutral float-right" title="Hyperparameter Tuning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="edev.html" class="btn btn-neutral float-left" title="Ensemble of Differential Evolution Variants (EDEV)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Exelon Corp. &amp; MIT.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>